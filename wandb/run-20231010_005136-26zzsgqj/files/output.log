loading model from : /jet/home/lisun/work/xinliu/fewshot/Renet-MLTI/checkpoints/isic/5shot-2way/test222/max_acc.pth
torch.Size([1, 640, 5, 5]) torch.Size([1, 640, 5, 5])
torch.Size([1, 1, 5, 5, 5, 5]) torch.Size([1, 1, 5, 5, 5, 5])
attn:  torch.Size([5, 5])
img_size:  torch.Size([84, 84, 3])
Traceback (most recent call last):
  File "/ocean/projects/asc170022p/lisun/xinliu/fewshot/Renet-MLTI/htpm.py", line 97, in <module>
    attn_heatmap(img_s_bs, img_q_bs, attn_s, attn_q)
  File "/ocean/projects/asc170022p/lisun/xinliu/fewshot/Renet-MLTI/htpm.py", line 20, in attn_heatmap
    img_s_heatmap = show_heatmap_on_image(img_s, attn_s_qs_normalized)
  File "/ocean/projects/asc170022p/lisun/xinliu/fewshot/Renet-MLTI/htpm.py", line 34, in show_heatmap_on_image
    attended_img = heatmap + np.float32(img_)
ValueError: operands could not be broadcast together with shapes (5,5,3) (84,84,3)
Traceback (most recent call last):
  File "/ocean/projects/asc170022p/lisun/xinliu/fewshot/Renet-MLTI/htpm.py", line 97, in <module>
    attn_heatmap(img_s_bs, img_q_bs, attn_s, attn_q)
  File "/ocean/projects/asc170022p/lisun/xinliu/fewshot/Renet-MLTI/htpm.py", line 20, in attn_heatmap
    img_s_heatmap = show_heatmap_on_image(img_s, attn_s_qs_normalized)
  File "/ocean/projects/asc170022p/lisun/xinliu/fewshot/Renet-MLTI/htpm.py", line 34, in show_heatmap_on_image
    attended_img = heatmap + np.float32(img_)
ValueError: operands could not be broadcast together with shapes (5,5,3) (84,84,3)